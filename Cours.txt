De nos jours, on préfère utiliser des estimateurs locaux de la densité des points et explorer différentes échelles. Par exemple :\begin{lstlisting}[language=html]hist( survey$Height, col = grey(0.9), border = grey(0.8),      main = paste("Taille de", nrow(survey), "étudiants"),      xlab = "Taille [cm]",      proba = TRUE)lines(density(survey$Height, na.rm = TRUE), lwd = 2)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob12.png}\end{center}\end{figure}Le paramètre important de la fonction \textit{density()} est le paramètre \textit{adjust} :\begin{itemize}  \item \textit{adjust = 1} : C'est la valeur par défaut, celle que nous avons utilisée dans le graphe précédent.  \item \textit{adjust < 1} : On regarde les choses de près, on va vers la nature discrète de la variable.  \item \textit{adjust > 1} : On regarde les choses de loin, on veut lisser le signal pour voir la variable comme étant continue.\end{itemize}\begin{lstlisting}[language=html]hist( survey$Height, col = grey(0.9), border = grey(0.8),      main = paste("Taille de", nrow(survey), "étudiants"),      xlab = "Taille [cm]",      proba = TRUE)lines(density(survey$Height, na.rm = TRUE, adjust = 0.60), lwd = 2)mtext("adjust = 0.15")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob13.png}\end{center}\end{figure}\begin{lstlisting}[language=html]hist( survey$Height, col = grey(0.9), border = grey(0.8),      main = paste("Taille de", nrow(survey), "étudiants"),      xlab = "Taille [cm]",      proba = TRUE)lines(density(survey$Height, na.rm = TRUE, adjust = 2), lwd = 2)mtext("adjust = 2")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob14.png}\end{center}\end{figure}Un autre avantage des estimateurs locaux de la densité par rapport aux histogrammes est qu'il permettent de superposer facilement plusieurs distributions :\begin{lstlisting}[language=html]par(lend="butt")ng <- sum(survey$Sex == "Male", na.rm = TRUE)nf <- sum(survey$Sex == "Female", na.rm = TRUE)n <- ng + nfdst <- density(survey$Height, na.rm = TRUE)dstg <- density(survey$Height[survey$Sex == "Male"], na.rm = TRUE)dstf <- density(survey$Height[survey$Sex == "Female"], na.rm = TRUE)hist( survey$Height, col = grey(0.9), border = grey(0.8),      main = paste("Taille de", nrow(survey), "étudiants"),      xlab = "Taille [cm]",      proba = TRUE, ylim = c(0, max(dst$y)))lines(dstg$x, ng/n*dstg$y, lwd = 3, col = "darkblue")lines(dstf$x, nf/n*dstf$y, lwd = 3, lty = 2, col = "darkred")lines(dst$x, dst$y)legend("topright", inset = 0.01, legend = c("Filles", "Garcons","Total"),       col = c("darkred","darkblue","black"),       lty = c(2, 1,1), lwd = 2, pt.cex = 2)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob15.png}\end{center}\end{figure}\subsubsection{Variables discrètes}\paragraph{Diagramme en bâtons}Quand la nature discrète de la variable étudiée ne fait pas de doute, on utilise en général un diagramme en bâtons :\begin{lstlisting}[language=html]library(ade4)data(deug)plot(table(deug$tab$Option1), main = paste("Notes de", nrow(deug$tab),                                           "étudiants"),     las = 1, xlab = "note (Option 1)", ylab = "Nombre d'étudiants")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob16.png}\end{center}\end{figure}On peut considérer les diagramme en bâtons comme une forme dégénérée des estimateurs locaux de densité quand le paramètre \textit{adjust} est très petit :\begin{lstlisting}[language=html]plot(table(deug$tab$Option1), main = paste("Notes de", nrow(deug$tab),                                           "étudiants"),     las = 1, xlab = "note (Option 1)", ylab = "Nombre d'étudiants")dst <- density(deug$tab$Option1, adjust = 0.1)lines(dst$x, max(table(deug$tab$Option1))*dst$y/max(dst$y), col = "red")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob17.png}\end{center}\end{figure}Les paramètres graphiques \textit{lend} (line end : fin des lignes) et \textit{lwd} (line width : épaisseur des lignes) permettent de contrôler l'aspect terminal des bâtons et l'épaisseur des bâtons :\begin{lstlisting}[language=html]plot(table(deug$tab$Option1), main = paste("Notes de", nrow(deug$tab),                                           "étudiants"),     las = 1, xlab = "note (Option 1)", ylab = "Nombre d'étudiants",     lwd = 5, lend = "square")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob18.png}\end{center}\end{figure}\subsubsection{Variables continues}\paragraph{Boîte à moustaches}Nous avons déjà vu l'utilisation pour les variables continues des histogrammes et des estimateurs de la densité locale. On peut également utiliser une représentation en boîte à moustaches :\begin{lstlisting}[language=html]boxplot( survey$Pulse, col = grey(0.8),         main = paste("Rythme cardiaque de", nrow(survey), "étudiants"),         ylab = "Pulsations/minutes", las = 1)rug(survey$Pulse, side = 2)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob19.png}\end{center}\end{figure}La signification est explicitée dans le graphique suivant :\begin{lstlisting}[language=html]boxplot( survey$Pulse, col = grey(0.8),         main = paste("Rythme cardiaque de", nrow(survey), "étudiants"),         ylab = "Pulsations/minutes", las = 1)rug(survey$Pulse, side = 2)abline( h = median(survey$Pulse, na.rm = TRUE), col = "navy")text(1.35, 70, "Médiane", col = "navy")Q1 <- quantile(survey$Pulse, probs = 0.25, na.rm = TRUE)abline( h = Q1, col = "darkred")text(1.25, 62, "Q1 : premier quartile", col = "darkred")Q3 <- quantile(survey$Pulse, probs = 0.75, na.rm = TRUE)abline( h = Q3, col = "darkred")text(1.25, 83, "Q3 : troisième quartile", col = "darkred")arrows(x0 = 0.7,y0 =quantile(survey$Pulse, probs = 0.75, na.rm = TRUE),x1 = quantile(survey$Pulse, probs = 0.25, na.rm = TRUE),y1 = quantile(survey$Pulse, probs = 0.25, na.rm = TRUE),length = 0.1,code = text(0.7, 69, "h", pos = 2))mtext("L'écart inter-quartile h contient 50 % des individus", side = 1)abline( h = Q1-1.5*(Q3-Q1), col = "darkgreen")text(1.35, 42, "Q1 -1.5 h", col = "darkgreen")abline( h = Q3+1.5*(Q3-Q1), col = "darkgreen")text(1.35, 104, "Q3 +1.5 h", col = "darkgreen")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob20.png}\end{center}\end{figure}Les boîtes à moustaches permettent de comparer facilement des groupes d'individus, par exemple ici les garçons et les filles :\begin{lstlisting}[language=html]boxplot(survey$Pulse~survey$Sex, col = c("lightpink","lightblue"),        main = paste("Rythme cardiaque de", nrow(survey), "étudiants"),        ylab = "Pulsations/minutes", las = 1)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob21.png}\end{center}\end{figure}Une extension intéressante des boîtes à moustaches consiste à ajouter des encoches pour représenter un intervalle de confiance pour la médiane de chaque groupe :\begin{lstlisting}[language=html]boxplot( survey$Pulse~survey$Sex, col = c("lightpink","lightblue"),         main = paste("Rythme cardiaque de", nrow(survey), "étudiants"),         ylab = "Pulsations/minutes", las = 1, notch = TRUE)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob22.png}\end{center}\end{figure}Ainsi, nous n'avons pas d'indication forte qu'il y ait une différence du rythme cardiaque entre les filles et les garçons. Pour ce qui est de la taille on trouve que les garçons sont significativement plus grands que les filles.\begin{lstlisting}[language=html]boxplot( survey$Height~survey$Sex, col = c("lightpink","lightblue"),         main = paste("Taille de", nrow(survey), "étudiants"),         ylab = "Taille [cm]", las = 1, notch = TRUE)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob23.png}\end{center}\end{figure}\paragraph{Diagrammes en violon}Les diagrammes en violon essayent de combiner les avantages des boîtes à moustaches et des estimateurs de la densité locale, par exemple : \begin{lstlisting}[language=html]library(sm)library(vioplot)par(las = 1)vioplot(survey$Height[!is.na(survey$Height)], h = 1.5, names ="",        col = "lightblue")title(main = paste("Taille de", nrow(survey), "étudiants"))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob24.png}\end{center}\end{figure}\subsection{Variables qualitatives}\subsubsection{Variables nominales et ordonnées}Les variables \textbf{qualitatives} sont toutes les variables à valeur non numérique (\textit{e.g.} bleu, blanc, rouge) et codéees par les \textit{factor()}.Les variables qualitatives peuvent être :\begin{itemize}  \item \textbf{nominales} sans ordre particulier : un simple nom.  \item \textbf{ordonnées} avec un ordre : un peu, beaucoup, passionnément, à la folie.\end{itemize}La règle est simple : s'il y a un ordre, vos graphiques doivent \textbf{impérativement} le respecter.\subsubsection{Variables qualitatives nominales}Nous allons illustrer le cas des variables qualitatives non ordonnées avec un jeu de données réelles portant sur $592$ étudiants (extrait de Snee, R. D. (1974) Graphical \textit{display of two-way contingency tables. The American Statistician}, \textbf{28} :9-12). Pour chaque étudiant on a observé 3 variables qualitatives :\begin{enumerate}  \item la couleur des cheveux  \item la couleur des yeux  \item le sexe\end{enumerate}\begin{lstlisting}[language=html] genet <- read.table("http://pbil.univ-lyon1.fr/R/donnees/qualitatif.txt",+                     header=TRUE) summary(genet)   cheveux          yeux          sexe     Blond :127   Bleu    :215   Femelle:328   Marron:286   Marron  :220   Male   :264   Noir  :108   Noisette: 93                 Roux  : 71   Vert    : 64 \end{lstlisting}\paragraph{Diagrammes en secteurs}Intéressons nous à la couleur des cheveux. On peut représenter les données sous la forme d'un diagramme en secteurs avec la fonction \textit{pie()} :\begin{lstlisting}[language=html]pie(table(genet$cheveux), col = c("yellow", "chocolate4", "black", "orangered"),    main = "Couleur des cheveux de 592 étudiants")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob25.png}\end{center}\end{figure}Mais c'est une mauvaise idée. En effet, la documentation de la fonction \textit{pie()} nous dit :\begin{center}\textit{Pie charts are a very bad way of displaying information. The eye is good at judging linear measures and bad at judging relative areas. A bar chart or dot chart is a preferable way of displaying this type of data.\footnote{  Les Pie charts sont une très mauvaise façon d'afficher L'œil est bon pour juger les mesures linéaires mauvais pour juger les aires relatives. Un graphique à barres ou à point est préférable pour afficher ce type de données.}}\end{center}On peut s'en convaincre facilement à l'aide de l'exemple suivant :\begin{lstlisting}[language=html]set.seed(01071966)data <- rep(10,10) + rep( 2*runif(5), rep(2,5)) + rep(c(-2,2),5)data <- 100*data/sum(data) # as percentagenames(data) <- letters[1:10]par(mfrow = c(1, 2))pie(data, main = "Diagramme en secteur")dotchart(data, xlim = c(0, 14), pch = 19, main = "Graphe de Cleveland")par(mfrow = c(1, 1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob26.png}\end{center}\end{figure}\textbf{Note : } le \textit{set.seed()} le vrai aléatoire n'existe pas donc il existe différent moteur d'aléatoire. La fonction set.seed permet de fixer ce moteur pour tout ce qui contient un processus "aléatoire". L'avantage est de pouvoir obtenir du code reproductible pour les fois où l'on fait appel à un processus aléatoire (simulation, bootstrap....).  Sinon à chaque fois que l'on fait tourner le code tu obtiens un résultat (un peu) différent. Grâce à ça le résultat est reproductible d'une session à l'autre, d'un ordinateur à l'autre.\paragraph{Diagrammes en secteurs - graphe de Cleveland}Il faut donc éviter d'utiliser des diagrammes en secteurs. Avec notre exemple sur la couleur des cheveux de 592 étudiants, On voit par exemple que l'écart entre les Noir et les Roux est plus important que l'écart entre les Blond et les Noir. On ne le voit pas avec un diagramme en secteurs.\begin{lstlisting}[language=html]data <- sort(as.numeric(table(genet$cheveux)))par(mfrow = c(1, 2))pie(data, col = c("orangered", "black", "yellow2", "chocolate4"), cex = 1.5)dotchart(data, xlim = c(0, max(data)), pch = 21, bg = c("orangered","black","yellow2","chocolate4"), cex = 1.5)par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob27.png}\end{center}\end{figure}\paragraph{Graphe de Cleveland}Quand le nombre de modalités est important, on a tout intérêt à les classer en fonction de leur fréquence pour faciliter les comparaisons. Illustrons ceci avec un jeu de données consistant en un échantillon de 93 voitures sur lesquelles on a observé une variable qualitative non-ordonnéee : le nom du constructeur.\begin{lstlisting}[language=html]library(MASS)data(Cars93)par(mfrow=c(1,2))dotchart(as.numeric(table(Cars93$Manufacturer)), pch=19, cex = 0.8,         main="Dans le desordre")dotchart(sort(as.numeric(table(Cars93$Manufacturer))), pch=19, cex = 0.8,         main = "Dans l'ordre")par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob28.png}\end{center}\end{figure}\subsubsection{Variables qualitatives ordinales}Les passagers du Titanic pouvaient voyager en première classe (\textit{1st}), en seconde classe (\textit{2nd}) ou en troisième classe (\textit{3rd}). La variable classe est donc une variable qualitative ordinales dont les trois modalités sont \textit{1st, 2nd} et \textit{3rd}.\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob29.png}\end{center}\end{figure}Récupérons les données historiques nous donnant le nombre de voyageur de chaque classe :\begin{lstlisting}[language=html] data(Titanic) classe <- apply(Titanic, 1, sum)[1:3] classe1st 2nd 3rd 325 285 706 \end{lstlisting}Il y avait donc 323 passagers en première classe, 285 en seconde classe et 706 en troisième classe.\begin{lstlisting}[language=html]pie(classe,main="Don't try this at home kids!")\end{lstlisting}\textcolor{red}{\textit{Horreur ! La premiere classe jouxte la troisième classe !}}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob30.png}\end{center}\end{figure}Il faut préserver l'ordre des modalités, c'est facile avec un diagramme de Cleveland :\begin{lstlisting}[language=html]dotchart(rev(classe), main="Classe des passagers du Titanic", pch = 19,         xlim = c(0,max(classe)), cex = 1.5)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob31.png}\end{center}\end{figure}\subsection{Croisement de variables}\subsubsection{Croisement qualitatif qualitatif}\paragraph{Tables de contingence} Quand on croise deux variables qualitatives on obtient une table de contingence, par exemple :\begin{lstlisting}[language=html] genet <- read.table("http://pbil.univ-lyon1.fr/R/donnees/qualitatif.txt",header=TRUE) (tc <- table(genet[,1:2]))        yeuxcheveux  Bleu Marron Noisette Vert  Blond    94      7       10   16  Marron   84    119       54   29  Noir     20     68       15    5  Roux     17     26       14   14\end{lstlisting}On peut utiliser la fonction \textit{balloonplot()} pour faire une représentation directe des données :\begin{lstlisting}[language=html]library(gdata)library(gtools)library(gplots)balloonplot(tc, dotsize=10)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob32.png}\end{center}\end{figure}\paragraph{Tables de contingence : hypothèse d'indépendance} Sous l'hypothèse d'indépendance entre les deux variables, on déduit facilement les effectifs attendus :$$\begin{aligned}P(A\cap B) & = P(A)P(B) \\ & = \frac{n_{A}}{n} \times \frac{n_{B}}{n}\end{aligned}$$Et ainsi : $$n_{A\cap B} = \frac{n_{A}\times n_{B}}{n}$$Graphiquement :\begin{lstlisting}[language=html]par(mfrow = c(1,2))balloonplot(tc, dotsize=8, main = "Observé")balloonplot(as.table(chisq.test(tc)$expected), dotsize=8, main = "Attendu")par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob33.png}\end{center}\end{figure}Les représentations directes ne permettent pas de faire facilement des comparaisons. Pour visualiser les écarts par rapport à l'hypothèse d'indépendance, on peut utiliser la fonction \textit{mosaicplot()} :\begin{lstlisting}[language=html]mosaicplot(tc, shade = TRUE, las =1,           main = paste("Yeux et cheveux de", nrow(genet),"étudiants"))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob34.png}\end{center}\end{figure}\subsubsection{Croisement numérique qualitatif}Nous avons vu deux façon de représenter la distribution d'une variable numérique en fonction d'une variable qualitative :\begin{enumerate}\item Avec des estimateurs de la densité locale.\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob15.png}\end{center}\end{figure}\item Avec des boîtes à moustache.\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob23.png}\end{center}\end{figure}\end{enumerate}A noter l'option \textit{varwidth = TRUE} qui permet de conserver graphiquement l'information sur les effectifs des groupes dans le cas d'une représentation avec des boîtes à moustaches.\begin{lstlisting}[language=html]boxplot(deug$tab$Algebra~deug$result, at = c(1, 5, 6, 2, 3, 4),        col = grey(0.8), xlab = "Resultat final", ylab = "Note en Algebre",        varwidth = TRUE,        main = paste("Notes de", nrow(deug$tab),"étudiants"))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob35.png}\end{center}\end{figure}\subsubsection{Croisement numérique numérique}\paragraph{Les nuages de points}On utilise classiquement un nuage de points, où chaque point représente un individu. Exemple :\begin{lstlisting}[language=html]plot(x = deug$tab$Proba, y = deug$tab$Algebra, pch = 20,     main = paste("Notes de", nrow(deug$tab),"étudiants"),     xlab = "Note en Probabilité", ylab = "Note en Algèbre", las = 1)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob36.png}\end{center}\end{figure}\paragraph{Le problème de la superposition des points}La principale difficulté des nuages de points vient de la gestion de la superposition des points. Nous allons illustrer ce point avec un exemple simple : la taille et la longueur du majeur de 3000 criminels (les données du test t de Student).\subparagraph{Un nuage de points trompeur}\begin{lstlisting}[language=html]data(crimtab)crimtab.dft <- as.data.frame(crimtab)str(crimtab.dft)'data.frame': 924 obs. of  3 variables: $ Var1: Factor w/ 42 levels "9.4","9.5","9.6",..: 1 2 3 4 5 6 7 8 9 10 ... $ Var2: Factor w/ 22 levels "142.24","144.78",..: 1 1 1 1 1 1 1 1 1 1 ... $ Freq: int  0 0 0 0 0 0 1 0 0 0 ...head(crimtab.dft,3)  Var1   Var2 Freq1  9.4 142.24    02  9.5 142.24    03  9.6 142.24    0expand.dft <- function(x, na.strings = "NA", as.is = FALSE, dec = ".") {   DF <- sapply(1:nrow(x), function(i) x[rep(i, each = x$Freq[i]), ],                simplify = FALSE)   DF <- subset(do.call("rbind", DF), select = -Freq)   for (i in 1:ncol(DF))   {     DF[[i]] <- type.convert(as.character(DF[[i]]),                             na.strings = na.strings,                             as.is = as.is, dec = dec)   }   DF } crimtab.raw <- expand.dft(crimtab.dft) x <- crimtab.raw[,1] y <- crimtab.raw[,2] plot(x, y, las = 1, main = "3000 criminels", ylab = "Taille [cm]",      xlab = "Majeur gauche [cm]")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob37.png}\end{center}\end{figure}\subparagraph{Tournesol (sunflower)}Premier palliatif possible : utiliser la représentation donnée par \textit{sunflowerplot()} : en cas de superposition on trace autant de rayons qu'il y a de superpositions, d'où le nom de tournesol.\begin{lstlisting}[language=html]sunflowerplot(crimtab.raw, las = 1, main = "3000 criminels",ylab = "Taille [cm]", xlab = "Majeur gauche [cm]", size = 1/20)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob38.png}\end{center}\end{figure}Deuxième palliatif possible : utiliser des symboles dont la surface est proportionnelle au nombre de points superposés.\begin{lstlisting}[language=html]xyg <- expand.grid(as.numeric(rownames(crimtab)),                   as.numeric(colnames(crimtab)))symbols(x = xyg[,1], y = xyg[,2], circles = sqrt(as.vector(crimtab)),        inches = 0.2, bg = rgb(0.5,0.5,0.5,0.5), xlab = "x", ylab ="y", las=1,        main = "Avec des symboles de taille variable")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob39.png}\end{center}\end{figure}Troisième palliatif possible : bruiter les données ! C'est une solution qui semble paradoxale à première vue puisque l'on dégrade l'information mais qui donne souvent de bons résultats du point de vue de la perception globale de l'information.\begin{lstlisting}[language=html]par(mfrow = c(1,2))plot(x, y, main = "Sans bruitage")plot(jitter(x), jitter(y), main = "Avec bruitage")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob40.png}\end{center}\end{figure}Quatrième palliatif possible : utiliser un estimateur de la densité locale des points (comme density() mais en 2 dimensions). On peut utiliser la fonction kde2d() de la bibliothèque MASS.\begin{lstlisting}[language=html]edl <- kde2d(x,y, n = 100)image(edl, main = "Avec un estimateur de la densite locale",      xlab = "x", ylab = "y")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob41.png}\end{center}\end{figure}\begin{lstlisting}[language=html]contour(edl, main = "Avec un estimateur de la densite locale", xlab = "x",ylab = "y")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob42.png}\end{center}\end{figure}\begin{lstlisting}[language=html]filled.contour(edl, main = "Avec un estimateur de la densite locale",xlab = "x", ylab = "y", color = terrain.colors)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob43.png}\end{center}\end{figure}\begin{lstlisting}[language=html]filled.contour(edl, main = "Avec un estimateur de la densite locale",xlab = "x", ylab = "y", color = heat.colors)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob44.png}\end{center}\end{figure}\begin{lstlisting}[language=html]filled.contour(edl, main = "Avec un estimateur de la densite locale",xlab = "x", ylab = "y", color = topo.colors)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob45.png}\end{center}\end{figure}\begin{lstlisting}[language=html]filled.contour(edl, main = "Avec un estimateur de la densite locale",xlab = "x", ylab = "y", color = cm.colors)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob46.png}\end{center}\end{figure}\begin{lstlisting}[language=html]smoothScatter(x,y)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob47.png}\end{center}\end{figure}\begin{lstlisting}[language=html]persp(edl, xlab = "x", ylab = "y", zlab = "density", theta = 45, phi = 20,main = "Avec un estimateur de la densite locale")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob48.png}\end{center}\end{figure}\textbf{Note : } Les valeurs de $\theta$ et $\varphi$ permettent d'orienter le graphique.\begin{lstlisting}[language=html]library(rgl)persp3d(edl, xlab = "x", ylab = "y", zlab = "density", theta = 45, phi = 20,      main = "Avec un estimateur de la densite locale")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob49.png}\end{center}\end{figure}\subsection{Courbes}\subsubsection{Tracé d'une fonction}On peut utiliser \textit{curve()} pour représenter des fonctions :\begin{lstlisting}[language=html]f <- function(x) { sin(x) + sin(0.9*x) }curve(f, from = 0, to = 50*pi, n = 1000, main = "Battements", ylim = c(-3,3), col = "purple")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob50.png}\end{center}\end{figure}\subsubsection{Série "Temporelles"}On peut utiliser des courbes pour représenter l'évolution d'une variable au cours du temps (où d'une autre variable) :\begin{lstlisting}[language=html]data(sunspots)plot(sunspots, main = "Évolution de la densité de taches solaires",     xlab = "Temps", ylab = "Taches solaires")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob51.png}\end{center}\end{figure}La représentation graphique précédente n'est pas bonne. Il faut que les courbes suivent au plus près la direction de la première ou de la deuxième bissectrice.\begin{lstlisting}[language=html]n <- 4wd <- seq( start(sunspots)[1], end(sunspots)[1], length = n+1)opar <- par(no.readonly = TRUE)par(mfrow = c(n,1), mar = c(3,3,1,1))for( i in 1:(length(wd)-1)){  plot( window(sunspots, wd[i], wd[i+1]), ylab = "", xlab = "", las = 1,        ylim = c(0,max(sunspots)))}par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob52.png}\end{center}\end{figure}On voit maintenant que les montées et descentes ne sont pas symétriques. On peut aussi lisser le signal avec divers outils, par exemple :\begin{lstlisting}[language=html]opar <- par(no.readonly = TRUE)par(mfrow = c(n,1), mar = c(3,3,1,1))for( i in 1:(length(wd)-1)){  plot(     window(sunspots, wd[i], wd[i+1]),     ylab = "", xlab = "", las = 1, col ="darkgrey",lwd = 0.8,    ylim = c(0,max(sunspots)))      lines(lowess(window(sunspots, wd[i], wd[i+1]), f = 0.025),     lwd = 1.3,col="red")}par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob53.png}\end{center}\end{figure}\subsection{Les paramètres graphiques}\subsubsection{Sauvegarde des paramètres graphiques}Les options des graphiques sont consultables et contrôlables avec la fonction \textit{par()} que l'on utilise typiquement de la façon suivante :\begin{lstlisting}[language=html]# On sauvegarde les options graphiques modifiables :old.par <- par(no.readonly = TRUE)# ...# ... plein de modifications des options graphiques,# ... par exemple par(mfrow = c(1, 2))# ...# On restaure les options graphiques précédentes :par(old.par)\end{lstlisting}\subsubsection{mfrow}Le paramètre \textit{mfrow} permet de disposer simultanément plusieurs graphiques.\begin{lstlisting}[language=html]par(mfrow = c(2,3))for(i in 1:6) plot(0, main = i)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob54.png}\end{center}\end{figure}\subsubsection{col*}Les paramètres \textit{col*} contrôlent la couleur des éléments du graphique.\begin{lstlisting}[language=html]par(mfrow = c(2,3))par(col = "red")plot(0, main = "col = \"red\"", sub = "sous-titre")par(col = "black", col.axis = "red")plot(0, main = "col.axis = \"red\"", sub = "sous-titre")par(col.axis = "black", col.lab = "red")plot(0, main = "col.lab = \"red\"", sub = "sous-titre")par(col.lab = "black", col.main = "red")plot(0, main = "col.main = \"red\"", sub = "sous-titre")par(col.main = "black", col.sub = "red")plot(0, main = "col.sub = \"red\"", sub = "sous-titre")par(col.sub = "black", fg = "red")plot(0, main = "fg = \"red\"", sub = "sous-titre")par(mfrow=c(1,1))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob55.png}\end{center}\end{figure}\subsubsection{mar}Ce paramètre contrôle les marges, exprimées en lignes de texte, du graphique qui par défaut sont :\begin{enumerate}  \item En bas : 5 lignes : une ligne pour les graduations (ticks), une ligne pour les étiquettes des graduations, une ligne vide, une ligne de légende, une ligne vide.  \item À gauche 4 lignes : une ligne pour les graduations, une ligne pour les labels des graduations, une ligne vide, une ligne de légende.  \item En haut : 4 lignes pour le titre.  \item À droite : 2 lignes vides.\end{enumerate}plus d'une bordure vide d'un dixième de ligne tout autour. Graphiquement :\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob56.png}\end{center}\end{figure}Pour ajouter une ligne à la marge de gauche, on utiliserait :\begin{lstlisting}[language=html]par(mfrow=c(1,1))par(mar = par("mar") + c(0, 1, 0, 0))plot(0, xlab = "xlab", ylab = "Une légende un peu bavarde\nsur deux lignes",     main = "main")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob57.png}\end{center}\end{figure}\subsubsection{usr}Ce paramètre donne les coordonnées extrêmes de la région utile du graphique, par exemple :\begin{lstlisting}[language=html]plot(1:10,main = par("usr"))\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob58.png}\end{center}\end{figure}Ces paramètres contrôlent la taille relative des chaînes de caractères, notez que les marges s'adaptent automatiquement à la taille des caractères :\begin{lstlisting}[language=html]par(mfrow=c(2,2))for(cex in seq(from = 0.8, to = 1.2, length = 4)){  par(cex=cex)  plot(0, main = paste("cex =", round(cex,1)))}\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob59.png}\end{center}\end{figure}\subsubsection{bg}La couleur de fond du graphique, attention les fonctions graphiques de haut niveau comme plot() ou points() ont un argument de même nom pour donner la couleur de remplissage des points :\begin{lstlisting}[language=html]par(mfrow=c(1,1))par(bg = "lightblue")plot(rnorm(100),rnorm(100), pch = 21, bg = "yellow")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob60.png}\end{center}\end{figure}\subsubsection{las}Le paramètre las contrôle le style des étiquettes des axes. A noter l'option \textit{las = 1} qui permet de lire tous les étiquettes facilement car elles sont alors horizontales.\begin{lstlisting}[language=html]par(bg = "white")par(mfrow=c(2,2))for(i in 0:3) plot(0,las=i,main=paste("las =",i), font.axis = 2,                   col.axis = "red")\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob61.png}\end{center}\end{figure}\subsubsection{xpd}Le paramètre xpd permet de déborder de la région utile du graphique, par exemple :\begin{lstlisting}[language=html]par(mfrow=c(1,1))plot(0)abline(h=0)par(xpd=NA)abline(h=0.5,col="red",lwd=2)\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob62.png}\end{center}\end{figure}\begin{lstlisting}[language=html]\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/lob.png}\end{center}\end{figure}\item[]\item[]\item[]\item[]\item[]\item[]\item[]\item[]\item[]\item[]                      \item[mot2 :] définition2.                       \item[mot2 :] définition2.                                        \item[mot2 :] définition2.                  \item[mot2 :] définition2.                   \item[mot2 :] définition2.                    \item[mot2 :] définition2.                     \item[mot2 :] définition2.                      \item[mot2 :] définition2.                       \item[mot2 :] définition2.  %%%%% REMPLACER LES ', à, ê, é, è, î, ù, é%%%%% REMPLACER LES '%%%%% REMPLACER LES '%%%%% REMPLACER LES ', à, ê, é, è, î, ù, é%%%%% REMPLACER LES '%%%%% REMPLACER LES '%%%%% REMPLACER LES ', à, ê, é, è, î, ù, é%%%%% REMPLACER LES '%%%%% REMPLACER LES 'On considère les commandes :\begin{lstlisting}[language=html]\end{lstlisting}Cela renvoie :\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/gra.png}\end{center}\end{figure}\begin{lstlisting}[language=html]\end{lstlisting}\begin{lstlisting}[language=html]\end{lstlisting}\begin{lstlisting}[language=html]\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/g1.png}\end{center}\end{figure}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/g1.png}\end{center}\end{figure}%%%%% REMPLACER LES '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\begin{multicols}{3}\end{multicols}////// \begin{description} \item[mot1 :] définition1 ; \item[mot2 :] définition2. \end{description}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\textbf{Référence des fonctions de R les plus courantes} - \textit{Mayeul KAUFFMANN - Mars 2009}\subsection{Aide}La plupart des fonctions de R ont une documentation en ligne\newline\\           \begin{description} \item[help(sujet) :] documentation sur un sujet. Flèches haut et bas pour se déplacer, touche q pour quitter ; \item[mot2 :] définition2. \end{description}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 00000000001000011111000010000000000000000000000% 00000000001000010000000010000000000000000000000% 00000000001000010000000010000000000000000000000% 00000000001000011111000010000000000000000000000% 00000000000000000000000000000000000000000000000%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 00000000001000011111000010000000000000000000000% 00000000001000010000000010000000000000000000000% 00000000001000010000000010000000000000000000000% 00000000001000011111000010000000000000000000000% 000000000000000000000000000000000000000000000 00%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\begin{lstlisting}[language=html]\end{lstlisting}v<-seq(10,60, by=10)w<-c(20,10,31,31,61,51)u<-c(5,5,5,32,62,49)##---------------------------------##---------------------------------##---------------------------------\textbf{Simple List}savehistory("Sauvegarde_historique_TP1.R")remove()savehistory("Sauvegarde_historique_TP1.R") \begin{description} \item[help(sujet) :] documentation sur un sujet. Flèches haut et bas pour se déplacer, touche q pour quitter ; \item[mot2 :] définition2. \end{description}\begin{lstlisting}[language=html]\end{lstlisting}\begin{figure}[H]\begin{center}\includegraphics[scale=0.5]{ilu/g1.png}\caption{Probabilité d'obtention de face entre 0 et 6}\end{center}\end{figure}